<?xml version="1.0" encoding="utf-8"?><Operation xmlns:clr="http://schemas.cleverence.ru/clr" fullscreen="Inherit" lock="No" name="ПросмотрОстатковOld" serverHosted="False"><Actions capacity="16" count="12"><ConditionAction breakPoint="False" comment="Если выбрана характеристика" expression="Поз.ИмяХарактеристики != null &amp;&amp; Поз.ИмяХарактеристики != &quot;&quot;" id="2e89ce23-deff-4323-b68f-397fe050f5c5" indent="0" nextDirection="" noDirection="2" yesDirection="" /><SelectDocumentLinesAction breakPoint="False" comment="Если выбрана характеристика" id="1395652e-5642-4418-8fd2-4fb1a84426d4" indent="1" name="3" nextDirection="" sessionVariable="ОстаткиХарактеристики"><Query copySelection="False" documentLines="Declared" from="{Остатки}" sourceWhereExpression="" tableAlias="{Остатки}" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.ИдНоменклатуры == Поз.Product.Id &amp;&amp; Item.ИдХарактеристики == Поз.ИдХарактеристики"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLinesAction><ItemsViewAction id="1bdad6bd-eca5-483f-8e20-0e7182b75ea7" indent="1" name="4" nextDirection="7" headerText="{GlobalVars.СпрятатьПомощь==True:;&lt;r size = &quot;-1&quot;&gt; esc - назад&lt;/r&gt;}&#xD;&#xA;&lt;r color=&quot;Black&quot;&gt;{Поз.Product.Name} - &lt;/r&gt;&lt;r size=&quot;+2&quot; color=&quot;SteelBlue&quot;&gt;&lt;b&gt;{Поз.ИмяХарактеристики}&lt;/b&gt;&lt;/r&gt;" footerText="&lt;button width=&quot;100%&quot; direction=&quot;2&quot;&gt;Все остатки товара&lt;/button&gt;" title="&lt;b size=&quot;+1&quot; color=&quot;SteelBlue&quot;&gt;Остатки&lt;/b&gt;" transactionNotch="True" cancelType="None" fullscreen="True" backgroundImage="" format="" selectedItem="SelectedItem" viewItems="{ОстаткиХарактеристики}" welcomeText=""><KeyJumps count="1"><KeyToAction action="abort" barcode="" condition="" foreColor="#00000000" key="Escape" modifiers="None" viewType="InMenu" /></KeyJumps><Columns count="3"><ItemsColumn align="TopLeft" allBorder="0" backColor="White" bottomBorder="0" format="{Item.Склад.Наименование}" leftBorder="0" rightBorder="0" topBorder="0" width="60%" /><ItemsColumn align="MiddleCenter" allBorder="0" backColor="White" bottomBorder="0" format="{Item.Количество}" leftBorder="0" rightBorder="0" title="Кол-во" topBorder="0" width="20%" /><ItemsColumn align="MiddleCenter" allBorder="0" backColor="White" bottomBorder="0" format="{Item.Резерв}" leftBorder="0" rightBorder="0" title="Резерв" topBorder="0" width="20%" /></Columns><Query copySelection="False" documentLines="Declared" sourceWhereExpression="" useTableAliasForItem="False" whereCompiled="False" whereExpression=""><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></ItemsViewAction><AssignAction breakPoint="False" expression="=&quot;&quot;" id="170c3da1-6219-426f-9999-beeb5fd29447" indent="1" name="7" nextDirection="4" /><SelectDocumentLinesAction breakPoint="False" id="4dc5b4e3-f055-4b62-91b3-c264b6aef7fd" indent="0" name="2" nextDirection="" sessionVariable="ОстаткиНоменклатуры"><Query copySelection="False" documentLines="Declared" from="{Остатки}" sourceWhereExpression="" tableAlias="{Остатки}" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.ИдНоменклатуры == Поз.Product.Id"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="1"><String>ИдСклада1С</String></SortBy><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLinesAction><AssignAction breakPoint="False" expression="i = 0;&#xD;&#xA;cnt = ОстаткиНоменклатуры.Count;&#xD;&#xA;res = new Cleverence.Warehouse.RowCollection();&#xD;&#xA;while(i &lt; cnt)&#xD;&#xA;{&#xD;&#xA;  if(i == 0 || ОстаткиНоменклатуры[i].ИдСклада1С != ОстаткиНоменклатуры[i-1].ИдСклада1С)&#xD;&#xA;  {&#xD;&#xA;   temp = res.AddNew();&#xD;&#xA;   temp.Заголовок = ОстаткиНоменклатуры[i].Склад.Наименование;&#xD;&#xA;  }&#xD;&#xA;res.Add(ОстаткиНоменклатуры[i]);&#xD;&#xA;temp.Количество = temp.Количество + ОстаткиНоменклатуры[i].Количество;&#xD;&#xA;temp.Резерв = temp.Резерв + ОстаткиНоменклатуры[i].Резерв;&#xD;&#xA;i = i + 1;&#xD;&#xA;}&#xD;&#xA;СтрокиДляПоказа = res;" id="f2debad1-91d9-4c5e-8deb-7855a7207aac" indent="0" nextDirection="6" /><SelectDocumentLinesAction breakPoint="False" id="024f269c-6b62-4ae5-82f5-2e7e9a099041" indent="0" nextDirection="" sessionVariable="ОстаткиНоменклатурыПоСкладам"><Query copySelection="False" documentLines="Declared" from="{ОстаткиНоменклатуры}" sourceWhereExpression="" tableAlias="{ОстаткиНоменклатуры}" useTableAliasForItem="False" whereCompiled="False" whereExpression=""><Fields count="0" /><GroupBy count="1"><String>ИдСклада1С</String></GroupBy><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLinesAction><AssignAction breakPoint="False" expression="СтрокиДляПоказа = new Cleverence.Warehouse.RowCollection()" id="234a557d-98b7-4544-8f7b-d6e43a96e290" indent="0" nextDirection="" /><ForeachAction breakPoint="False" buttonExit="True" canFinishAlways="False" cyclic="True" exitButtonText="Закончить набор" exitGroupCode="" fullscreen="Inherit" id="6d21bdd0-f667-496a-b6a9-4f9d1ebc6ee9" indent="0" items="{ОстаткиНоменклатурыПоСкладам}" nextDirection="" transactionNotch="False"><Actions capacity="16" count="12"><SelectDocumentLinesAction breakPoint="False" id="8568ece2-8b3d-4bc2-ac13-dad8f74726d1" indent="0" nextDirection="" sessionVariable="ПоСкладу"><Query copySelection="False" documentLines="Declared" from="{ОстаткиНоменклатуры}" sourceWhereExpression="" tableAlias="{ОстаткиНоменклатуры}" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.ИдСклада1С == SelectedLine.ИдСклада1С"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLinesAction><ConditionAction breakPoint="False" expression="ПоСкладу.Count &gt; 1" id="0e4edff9-41e6-4ae7-98c2-d02da1e0576a" indent="0" nextDirection="" noDirection="1" yesDirection="" /><AssignAction breakPoint="False" expression="копия = new Cleverence.Warehouse.Row();&#xD;&#xA;копия.Группа = 1;&#xD;&#xA;копия.СкладНаименование = ПоСкладу[0].Склад.Наименование;" id="f540e2ee-25d2-4aee-bc3f-ffb39f7614eb" indent="1" nextDirection="2" /><AssignAction breakPoint="False" expression="СтрокиДляПоказа.Add(копия)" id="e1451a93-797a-48b8-84a2-36849fd22f5a" indent="1" name="2" nextDirection="" /><AssignAction breakPoint="False" expression="Колво=0" id="228db346-bbf9-4661-9a94-844e63305c68" indent="1" name="" nextDirection="" /><AssignAction breakPoint="False" expression="Резерв = 0" id="19cb3107-0de5-414d-8836-534977077287" indent="1" nextDirection="" /><AssignAction breakPoint="False" expression="СтрокаГруппы = копия" id="2f276bc1-4cfa-4460-b9ce-f7f9817f2bb4" indent="1" nextDirection="" /><AssignAction breakPoint="False" expression="СтрокаГруппы.Количество = 0" id="8c804e69-f94a-4b40-9484-a798ace138dc" indent="1" nextDirection="" /><ForeachAction breakPoint="False" buttonExit="True" canFinishAlways="False" cyclic="True" exitButtonText="Закончить набор" exitGroupCode="" fullscreen="Inherit" id="c3e5ec89-ea2d-4fa4-8e69-eb31a34e3bb8" indent="1" items="{ПоСкладу}" nextDirection="" transactionNotch="False"><Actions count="4"><AssignAction breakPoint="False" expression="SelectedLine.ВГруппе = 1" id="77fb25d0-e3bd-47dd-8bd4-61106c1dbd9f" indent="0" nextDirection="" /><AssignAction breakPoint="False" expression="Колво = Колво + SelectedLine.Количество" id="157405df-2bf3-427e-8df9-1b9b9766c4f8" indent="0" nextDirection="" /><AssignAction breakPoint="False" expression="Резерв = Резерв + SelectedLine.Резерв" id="268a97a2-c929-4bf5-8f4b-abe73b771d6a" indent="0" nextDirection="" /><AssignAction breakPoint="False" expression="СтрокиДляПоказа.Add(SelectedLine)" id="4c1cf0ab-08a4-4fcb-ae62-b34ba614712f" indent="0" nextDirection="" /></Actions><LockObjects count="0" /></ForeachAction><AssignAction breakPoint="False" expression="СтрокаГруппы.Количество = Колво" id="bb9028e0-c237-465f-9311-4ff3b765380f" indent="1" nextDirection="" /><AssignAction breakPoint="False" expression="СтрокаГруппы.Резерв = Резерв" id="a37dfe49-c71a-4ff1-8fbd-9c0e611d6254" indent="1" nextDirection="continue" /><AssignAction breakPoint="False" expression="СтрокиДляПоказа.Add(ПоСкладу[0])" id="bc97a9e2-934e-4090-904f-8602e27c15a3" indent="0" name="1" nextDirection="" /></Actions><LockObjects count="0" /></ForeachAction><ItemsViewAction id="5ddd6cd5-0680-43f3-afcd-a66b9ea0084d" name="6" nextDirection="" headerText="{GlobalVars.СпрятатьПомощь==True:;&lt;r size = &quot;-1&quot;&gt; esc - назад&lt;/r&gt;}&#xD;&#xA;&lt;r color=&quot;Black&quot;&gt;{Поз.Product.Name}&lt;/r&gt;&#xD;&#xA;" footerText="{Поз.ИмяХарактеристики != null &amp;&amp; Поз.ИмяХарактеристики != &quot;&quot;:&lt;button width=&quot;100%&quot; direction=&quot;5&quot;&gt;Остатки по характеристике&lt;/button&gt;;}" title="&lt;b size=&quot;+1&quot; color=&quot;SteelBlue&quot;&gt;Остатки&lt;/b&gt;" transactionNotch="True" cancelType="None" fullscreen="True" backgroundImage="" format="" selectedItem="SelectedItem" viewItems="{СтрокиДляПоказа}" welcomeText=""><KeyJumps count="1"><KeyToAction action="abort" barcode="" condition="" foreColor="#00000000" key="Escape" modifiers="None" viewType="InMenu" /></KeyJumps><Columns count="3"><ItemsColumn align="TopLeft" allBorder="0" backColor="White" bottomBorder="0" format="&lt;b&gt;{Item.Заголовок}&lt;/b&gt;{Item.Характеристика}" leftBorder="0" rightBorder="0" topBorder="0" width="60%" /><ItemsColumn align="MiddleCenter" allBorder="0" backColor="White" bottomBorder="0" format="{Item.Заголовок != &quot;&quot;:&lt;b&gt;{Item.Количество}&lt;/b&gt;;{Item.Количество}}" leftBorder="0" rightBorder="0" title="Кол-во" topBorder="0" width="20%" /><ItemsColumn align="MiddleCenter" allBorder="0" backColor="White" bottomBorder="0" format="{Item.Заголовок != &quot;&quot;:&lt;b&gt;{Item.Резерв}&lt;/b&gt;;{Item.Резерв}}" leftBorder="0" rightBorder="0" title="Резерв" topBorder="0" width="20%" /></Columns><Query copySelection="False" documentLines="Declared" sourceWhereExpression="" useTableAliasForItem="False" whereCompiled="False" whereExpression=""><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></ItemsViewAction><AssignAction breakPoint="False" expression="=&quot;&quot;" id="178b1c0a-c81a-4c09-8434-4aea255cb36b" indent="0" nextDirection="6" /><ClearSessionAction all="False" breakPoint="False" id="70a08c32-4c99-4af5-92c7-57187bad249e" indent="0" name="5" nextDirection="3"><KeyNames capacity="8" count="8"><String>СтрокиДляПоказа</String><String>СтрокаГруппы</String><String>ОстаткиНоменклатуры</String><String>ОстаткиНоменклатурыПоСкладам</String><String>ОстаткиХарактеристики</String><String>Колво</String><String>Резерв</String><String>копия</String></KeyNames></ClearSessionAction></Actions><Parameters count="1"><FieldInfo alias="" eanAI="None" fieldName="Поз" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="Poz" valueTemplate="" /></Parameters><Returns count="0" /></Operation>