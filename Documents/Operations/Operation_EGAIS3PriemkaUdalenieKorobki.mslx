<?xml version="1.0" encoding="utf-8"?><Operation xmlns:clr="http://schemas.cleverence.ru/clr" comment="ЕГАИС 3 | sh | Удаление/очистка коробки" fullscreen="Inherit" lock="AllOperations" name="ЕГАИС3 ПриемкаУдалениеКоробки" serverHosted="True"><Actions capacity="16" count="9"><GroupAction breakPoint="False" buttonExit="False" canFinishAlways="False" comment="Очистка коробки" cyclic="False" exitButtonText="Закончить набор" exitGroupCode="" fullscreen="Inherit" id="d50177a0-c094-498f-8074-d277ec1bb6f0" indent="0" name="Очистка коробки" nextDirection="" transactionNotch="False"><Actions capacity="8" count="6"><SelectDocumentLinesAction breakPoint="False" comment="Очистка коробки" id="3bb6dc92-c138-44e4-94e6-2176914dbef6" indent="0" name="ОчисткаКоробки" nextDirection="46" sessionVariable="НаУдаление"><Query copySelection="False" documentLines="Current" sourceWhereExpression="" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.РодительФакт == ИдРодителя"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLinesAction><ForeachAction breakPoint="False" buttonExit="True" canFinishAlways="False" cyclic="True" exitButtonText="Закончить набор" exitGroupCode="" fullscreen="Inherit" id="013042fb-6eb5-42e3-b54f-50d30e4ff9eb" indent="0" items="{НаУдаление}" nextDirection="" transactionNotch="False"><Actions count="2"><AssignAction breakPoint="False" expression="Плановая = Document.DeclaredItems.FindFirstByField(&quot;АлкоПДФ&quot;, SelectedLine.АлкоПДФ)" id="f94bea2c-a71c-481a-9c95-171823890ee4" indent="0" nextDirection="" /><AssignAction breakPoint="False" expression="Плановая.РодительФакт = &quot;&quot;;&#xD;&#xA;Плановая.ПоПлану = &quot;&quot;;&#xD;&#xA;Плановая.ПоПлануДаНет = &quot;&quot;;" id="ca169850-b692-4de8-91db-59c28489b0fd" indent="0" nextDirection="" /></Actions><LockObjects count="0" /></ForeachAction><ForeachAction breakPoint="False" buttonExit="True" canFinishAlways="False" cyclic="True" exitButtonText="Закончить набор" exitGroupCode="" fullscreen="Inherit" id="4916c3da-edcb-4b06-a890-e7dfe6f5bb58" indent="0" items="{СписокТоваров}" name="46" nextDirection="" transactionNotch="False"><Actions count="1"><AssignAction breakPoint="False" expression="SelectedLine.Факт = 0;&#xD;&#xA;if (SelectedLine.План == 0)&#xD;&#xA;{&#xD;&#xA;Document.Структура.Rows.Remove(SelectedLine);&#xD;&#xA;}" id="b4c87de2-0d91-4d68-98f5-fa1a0e7590cc" indent="0" nextDirection="" /></Actions><LockObjects count="0" /></ForeachAction><AssignAction breakPoint="False" comment="Очистка коробки" expression="i=0;&#xD;&#xA;while(i &lt; СписокКоробок.Count)&#xD;&#xA;{&#xD;&#xA;   if (СписокКоробок[i].Статус == &quot;новая&quot;)&#xD;&#xA;   {&#xD;&#xA;   Document.Коробки.Rows.Remove(СписокКоробок[i]);&#xD;&#xA;   }&#xD;&#xA;   else&#xD;&#xA;   {&#xD;&#xA;   СписокКоробок[i].Статус = &quot;&quot;;&#xD;&#xA;   СписокКоробок[i].РодительФакт = &quot;&quot;;&#xD;&#xA;   СписокКоробок[i].Внутри = &quot;&quot;;&#xD;&#xA;   СписокКоробок[i].Факт = 0;&#xD;&#xA;   СписокКоробок[i].Товар = &quot;&quot;;&#xD;&#xA;   СписокКоробок[i].УжеПроверено = null;&#xD;&#xA;   }&#xD;&#xA;i=i+1;&#xD;&#xA;}" id="b2331ebd-5f5a-461b-9917-b7c4f727edd4" indent="0" name="45" nextDirection="" /><RemoveDocumentLineAction breakPoint="False" comment="Удаление" id="35e0bd65-911b-48ad-9935-765b42565977" indent="0" name="44 1" nextDirection="" packing="" quantity="" quantityErrorDirection="" sessionVariable="НаУдаление" /><AssignAction breakPoint="False" expression="ОчиститьКоробку = false;&#xD;&#xA;ТекущаяКоробка.Внутри = &quot;непроверено&quot;;" id="22f6f8a9-cbda-4f09-af87-4a05c6a8b538" indent="0" nextDirection="" /></Actions><LockObjects count="0" /></GroupAction><ConditionAction breakPoint="False" comment="Удаление коробки" expression="УдаляемКоробку == true" id="a6dbe29a-7d0d-428d-859c-958ad04cb3fc" indent="0" name="121" nextDirection="" noDirection="return" yesDirection="" /><AssignAction breakPoint="False" comment="Удаление коробки" expression="ИдРодителя = ТекущаяКоробка.РодительФакт" id="aec68210-88db-484c-8698-bbbe77f26484" indent="0" nextDirection="" /><ConditionAction breakPoint="False" expression="НадоВычестьФакт == true" id="bb9d94c1-f6cc-47eb-9ae6-5ed93e0d19cf" indent="0" nextDirection="" noDirection="2610" yesDirection="" /><AssignAction breakPoint="False" expression="ПоискПоНом = Document.КоробкиВНоменклатуре.FindFirstByField(&quot;Номенклатура&quot;, ТекущаяКоробка.Номенклатура)" id="7735b804-c353-46d3-91c0-0385c6c5f0c9" indent="1" name="2609" nextDirection="" /><AssignAction breakPoint="False" expression="ПоискПоНом.Факт = ПоискПоНом.Факт - 1" id="c2463534-7fd6-4433-b8db-31f56a28652a" indent="1" nextDirection="" /><ConditionAction breakPoint="False" comment="Удаление коробки" expression="ТекущаяКоробка.Статус == &quot;новая&quot;" id="ff114503-8759-4449-b237-933f3e3a8034" indent="0" name="2610" nextDirection="" noDirection="119" yesDirection="" /><AssignAction breakPoint="False" comment="Удаление коробки" expression="Document.Коробки.Rows.Remove(ТекущаяКоробка);" id="842dbf25-2411-4671-a03c-c6fc228bec00" indent="1" nextDirection="return" /><AssignAction breakPoint="False" comment="Удаление коробки" expression="ТекущаяКоробка.Статус = &quot;&quot;;&#xD;&#xA;ТекущаяКоробка.РодительФакт = &quot;&quot;;&#xD;&#xA;ТекущаяКоробка.Внутри = &quot;&quot;;&#xD;&#xA;ТекущаяКоробка.Товар = &quot;&quot;;&#xD;&#xA;ТекущаяКоробка.УжеПроверено = null;&#xD;&#xA;ТекущаяКоробка.Факт = 0;" id="2940247a-ab7b-40b7-ac85-aad3c9cb431d" indent="0" name="119" nextDirection="return" /></Actions><Parameters capacity="8" count="6"><FieldInfo alias="" eanAI="None" fieldName="УдаляемКоробку" fieldType="Boolean" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="UdalyaemKorobku" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="ИдРодителя" fieldType="String" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="IdRoditelya" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="СписокКоробок" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="SpisokKorobok" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="СписокТоваров" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="SpisokTovarov" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="ТекущаяКоробка" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="TekushhayaKorobka" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="НадоВычестьФакт" fieldType="Boolean" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="NadoVychestFakt" valueTemplate="" /></Parameters><Returns count="4"><ReturnFieldInfo alias="" eanAI="None" fieldName="ТекущаяКоробка" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" returnNull="True" uni="TekushhayaKorobka" valueTemplate="" /><ReturnFieldInfo alias="" eanAI="None" fieldName="СписокКоробок" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" returnNull="True" uni="SpisokKorobok" valueTemplate="" /><ReturnFieldInfo alias="" eanAI="None" fieldName="СписокТоваров" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" returnNull="True" uni="SpisokTovarov" valueTemplate="" /><ReturnFieldInfo alias="" eanAI="None" fieldName="ИдРодителя" fieldType="String" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" returnNull="True" uni="IdRoditelya" valueTemplate="" /></Returns></Operation>