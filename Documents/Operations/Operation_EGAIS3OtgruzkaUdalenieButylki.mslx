<?xml version="1.0" encoding="utf-8"?><Operation xmlns:clr="http://schemas.cleverence.ru/clr" comment="ЕГАИС 3 | sh" fullscreen="Inherit" lock="AllOperations" name="ЕГАИС3 ОтгрузкаУдалениеБутылки" serverHosted="True"><Actions capacity="16" count="11"><ConditionAction breakPoint="False" expression="Document.ServerHosted == true" id="1bbece42-138d-48a1-97e9-6625b2402ee5" indent="0" nextDirection="" noDirection="Для одной строки 1 1" yesDirection="" /><ClearSessionAction all="False" breakPoint="False" id="523a3cc9-e8f6-4b59-9466-5b05123fff6c" indent="1" nextDirection=""><KeyNames count="1"><String>УжеБылТакойПДФ</String></KeyNames></ClearSessionAction><AssignAction breakPoint="False" comment="Уже была?" expression="УжеБылТакойПДФ = Document.CurrentItems.FindFirstByField(&quot;АлкоПДФ&quot;, ScannedBarcode)" id="9757953c-5c95-4045-8019-497600b87816" indent="1" nextDirection="" /><ConditionAction breakPoint="False" comment="Уже была?" expression="УжеБылТакойПДФ != null" id="ea4a166b-c37a-4d0a-8b02-7c4803651981" indent="1" nextDirection="" noDirection="abort" yesDirection="" /><SelectDocumentLineAction breakPoint="False" comment="Смотрим план" id="c298571f-47be-4628-b45f-55c14f4e42e3" indent="0" name="Для одной строки 1 1" nextDirection="" sessionVariable="ПланСтрока"><Query copySelection="False" documentLines="Declared" from="" sourceWhereExpression="" tableAlias="" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.Uid == УжеБылТакойПДФ.ПланСтрокаИд"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLineAction><AssignAction breakPoint="False" expression="ПланСтрока.CurrentQuantity = ПланСтрока.CurrentQuantity - 1;" id="5d91d076-febe-4594-a6ab-65191ea9290b" indent="0" nextDirection="" /><ConditionAction breakPoint="False" comment="Бутылка из коробки подбора?" expression="УжеБылТакойПДФ.УпакованоВ != null" id="4f379fd2-7a0c-440d-9810-6434cab6cbc0" indent="0" nextDirection="" noDirection="6" yesDirection="" /><SelectDocumentLineAction breakPoint="False" comment="Вычитаем бутылку из коробки подбора" id="74d87947-af11-44d9-8f39-a408bb6bff0a" indent="1" nextDirection="" sessionVariable="КоробкаПодбораМинус"><Query copySelection="False" documentLines="Declared" from="{Document.КоробкиФакт}" sourceWhereExpression="" tableAlias="{Document.КоробкиФакт}" useTableAliasForItem="False" whereCompiled="False" whereExpression="Item.Коробка == УжеБылТакойПДФ.УпакованоВ"><Fields count="0" /><GroupBy count="0" /><QueryParameters count="0" /><SortBy count="0" /><Where count="0" /><WhereRootElement>null</WhereRootElement></Query></SelectDocumentLineAction><AssignAction breakPoint="False" comment="Вычитаем бутылку из коробки подбора" expression="КоробкаПодбораМинус.Количество = КоробкаПодбораМинус.Количество - 1;" id="bf3e12f0-6b8e-43b9-9e24-a4623d8eda4d" indent="1" nextDirection="" /><ClearSessionAction all="False" breakPoint="False" comment="Вычитаем бутылку из коробки подбора" id="99ceb94b-a4c4-4a4f-88de-fbe8f70510c6" indent="1" nextDirection=""><KeyNames count="1"><String>КоробкаПодбораМинус</String></KeyNames></ClearSessionAction><RemoveDocumentLineAction breakPoint="False" id="fae3c9f0-6e89-44a3-84f3-4ba645b295dd" indent="0" name="6" nextDirection="" packing="" quantity="" quantityErrorDirection="return" sessionVariable="УжеБылТакойПДФ" /></Actions><Parameters count="2"><FieldInfo alias="" eanAI="None" fieldName="УжеБылТакойПДФ" fieldType="Object" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="UzheBylTakojPDF" valueTemplate="" /><FieldInfo alias="" eanAI="None" fieldName="ScannedBarcode" fieldType="String" isSQLIndex="False" isSQLKeyIndex="False" isSQLSubstringIndex="False" oneTimeTemplateExecution="False" uni="ScannedBarcode" valueTemplate="" /></Parameters><Returns count="0" /></Operation>